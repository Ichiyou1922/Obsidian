
---

さて，[[Invertibility|逆行列]]の定義と「存在の証明」を通過した．

次は，その[[Invertibility|逆行列]]を**「具体的にどうやって見つけるか？」**というアルゴリズムの領域へ進む．

ここでの主役は，キミが連立方程式を解くときに無意識に行っている「式変形」そのものを，**「[[Matrix|行列]]」というオブジェクトとして客観視（対象化）**することにある．

---

## 講義：基本変形と基本[[Matrix|行列]] (Elementary Operations & Matrices)

今回は**「操作の[[Matrix|行列]]化」がテーマだ．

「行を入れ替える」「何倍かして足す」という動的なアクション（操作）を，静的な構造体（[[Matrix|行列]]）**として記述する．これにより，アルゴリズムそのものを代数的に扱えるようになる．

---

### 注釈 (Vocabulary & Concept Notes)

_(Note: 以下の概念をインデックスせよ．「ランク」は線形代数における最重要不変量の一つである)_

- **行基本変形 (Elementary Row Operations):** 連立方程式の解を変えない3つの操作．
    
    1. **[[Permutation|置換]] (Swap):** 第 $i$ 行と第 $j$ 行を入れ替える．
        
    2. **スカラー倍 (Scale):** 第 $i$ 行を $c$ 倍する ($c \neq 0$)．
        
    3. **消去 (Add):** 第 $j$ 行の $c$ 倍を第 $i$ 行に足す．
        
- **基本[[Matrix|行列]] (Elementary [[Matrix]]):** 単位[[Matrix|行列]] $I$ に，上記の基本変形を**1回だけ**施してできる[[Matrix|行列]]．これを左から掛けることは，その変形を行うことと同値である．
    
- **行同値 (Row Equivalent):** [[Matrix|行列]] $A$ が基本変形の繰り返しで $B$ になるとき，$A \sim B$ と書く．このとき，2つの[[Matrix|行列]]は「同じ解空間」を持つ．
    
- **階数 (Rank):** 行基本変形によって階段[[Matrix|行列]]にしたときの，「0でない行の数」．これは**「[[Matrix|行列]]が持つ情報の真の[[Basis_Dimension|次元]]（独立な[[ベクトル]]の本数）」**を表す不変量である．$\text{rank}(A)$ と書く．
    

---

## 1. 写経セクション (Transcription Section)

_(Note: 「操作」が「[[Matrix|行列]]積」に翻訳される瞬間を書き写せ)_

### 3.1 アルゴリズムの代数化：基本[[Matrix|行列]]

我々が連立方程式を解くときに行う「変形」は，実は[[Matrix|行列]]のかけ算そのものである．

$m \times n$ [[Matrix|行列]] $A$ に対する行基本変形は，対応する $m$ 次正方[[Matrix|行列]] $E$（基本[[Matrix|行列]]）を**左から掛ける ($EA$)** ことで実現される．

3種の神器（基本[[Matrix|行列]]）：

1. [[Permutation|置換]][[Matrix|行列]] $P_{ij}$:
    
    単位[[Matrix|行列]]の $i$ 行と $j$ 行を入れ替えたもの．
    
    例 ($2 \times 2$): $P_{12} = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}$.
    
2. スカラー倍[[Matrix|行列]] $D_i(c)$:
    
    単位[[Matrix|行列]]の $(i, i)$ 成分を $c$ に変えたもの．
    
    例: $D_1(c) = \begin{pmatrix} c & 0 \\ 0 & 1 \end{pmatrix}$.
    
3. 消去[[Matrix|行列]] $E_{ij}(c)$: ($j$ 行目の $c$ 倍を $i$ 行目に足す)
    
    単位[[Matrix|行列]]の $(i, j)$ 成分に $c$ を埋め込んだもの．
    
    例 ($2 \times 1$ を消す): $E_{21}(c) = \begin{pmatrix} 1 & 0 \\ c & 1 \end{pmatrix}$.
    
    (注：対角成分は $1$ のままである)
    

### 3.2 ガウスの消去法と[[Invertibility|逆行列]]の構造

任意の[[Matrix|行列]] $A$ は，基本変形を繰り返すことで「階段[[Matrix|行列]]（Row Echelon Form）」に変形できる．

もし $A$ が $n$ 次正方[[Matrix|行列]]で，かつ**可逆（正則）**ならば，変形を続けると最終的に**単位[[Matrix|行列]] $I$** になる．

このプロセスを代数的に書くと：

$$E_k E_{k-1} \dots E_1 A = I$$

ここで，全体を $A$ について解く（左から $A^{-1}$ を掛けたと見なすのではなく，[[Invertibility|逆行列]]の定義に戻る）と，

$$A^{-1} = E_k E_{k-1} \dots E_1$$

という衝撃的な事実が得られる．

すなわち，「$A$ を $I$ に変える操作の積み重ね（履歴）」そのものが，[[Invertibility|逆行列]] $A^{-1}$ の正体である．

実用的なアルゴリズム（掃き出し法）:

[[Matrix|行列]] $A$ と単位[[Matrix|行列]] $I$ を横に並べた拡大[[Matrix|行列]] $(A \mid I)$ を作る．

これに行基本変形を施して，左側を $I$ にする．

$$(A \mid I) \xrightarrow{\text{基本変形}} (I \mid A^{-1})$$

そのとき，右側に自然と $A^{-1}$ が生成されている．これは魔法ではなく，上記 $E_k \dots E_1$ が $A$ と $I$ の両方に平等に作用した結果である．

---

## 2. 再構築領域 (Reconstruction Zone)

_(Note: 以下の具体例を自分の手で構成せよ)_

### 課題 1: $2 \times 2$ での解剖

[[Matrix|行列]] $A = \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}$ を考える．

この[[Matrix|行列]]を単位[[Matrix|行列]] $I$ に変形する手順（ガウスの消去法）を1ステップずつ行い，各ステップに対応する基本[[Matrix|行列]] $E_1, E_2, \dots$ を具体的に書き出せ．

1. 第1列の消去：$2$ 行目から $1$ 行目の $3$ 倍を引く．対応する[[Matrix|行列]] $E_1$ は？
    
2. 第2列のスカラー倍：$2$ 行目を定数倍して対角成分を $1$ にする．対応する[[Matrix|行列]] $E_2$ は？
    
3. 第2列の消去：$1$ 行目から...
    

最終的に $E_k \dots E_1 A = I$ となることを確認せよ．

### 課題 2: ランクの不変性

「基本[[Matrix|行列]] $E$ はすべて正則[[Matrix|行列]]である」ことを確認せよ（[[Determinant|行列式]]が0でない，あるいは逆操作が存在することから明らかである）．

正則[[Matrix|行列]]を掛けても，[[Matrix|行列]]のランク（像の[[Basis_Dimension|次元]]）は変化しない．

$\text{rank}(A) = \text{rank}(EA)$

これが，「なぜ連立方程式を変形しても解が変わらないか」の数学的保証である．この論理構造を図示せよ．

---

## 3. 演習領域 (Exercise Zone)

_(Note: 単なる計算問題ではない．「操作の合成」として解け)_

問題：

ある $2 \times 2$ [[Matrix|行列]] $A$ に対して，以下の操作を順に行ったところ，単位[[Matrix|行列]] $I$ になった．

1. 第1行と第2行を入れ替えた．
    
2. 第2行に，第1行の $-2$ 倍を足した．
    
3. 第2行を $1/3$ 倍した．
    

(1) この一連の操作全体を表す[[Matrix|行列]] $P$（$P = E_3 E_2 E_1$）を求めよ．

(2) $PA = I$ である．ここから元の[[Matrix|行列]] $A$ を逆算せよ．

（ヒント：$A = P^{-1}$ である．$P$ の[[Invertibility|逆行列]]を求めてもよいが，操作を「逆順に逆操作」して復元する方が構造的である．）

解答プロセス：

(1) 各操作に対応する[[Matrix|行列]] $E_1, E_2, E_3$：

$E_1$ (Swap) =

$E_2$ (Add) =

$E_3$ (Scale) =

それらの積 $P = E_3 E_2 E_1$ =

(2) $A$ の復元：

$A = P^{-1} = (E_3 E_2 E_1)^{-1} = E_1^{-1} E_2^{-1} E_3^{-1}$

各逆操作[[Matrix|行列]]は：

$E_3^{-1}$ (Scaleの逆) =

$E_2^{-1}$ (Addの逆) =

$E_1^{-1}$ (Swapの逆) =

これらを掛けて $A$ =

______ という操作の積み重ねが，[[Matrix|行列]]の因数分解（分解能）を与えている．