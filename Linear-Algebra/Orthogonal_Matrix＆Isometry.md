**Mode B: 質疑応答 (Q&A Mode)**

キミの「引っかかり」は非常に良い．

それは**「幾何学的イメージ（角度・長さ）」と「代数的定義（線形性）」の接続部分**で発生している摩擦だ．

一つずつ紐解こう．

### 1. 再構築領域：なぜ $\cos$ を使うと泥沼にはまるのか

キミの式変形における最大の躓きポイントはここだ．

> $w=\sum_{i=1}^{k}(x, e_j)e_j=\sum_{i=1}^{k}||x||cos\theta_1 e_i$

ここで $\theta$ は「$x$ と $e_i$ のなす角」なので，本来はインデックス $i$ に依存して $\theta_i$ と書くべきものである．

すると $w$ は「様々な方向のベクトル $e_i$ を，それぞれの重みで足し合わせたもの」になる．

これのノルム $\|w\|$ を計算しようとすると，三平方の定理の一般化が必要になり，単純な $\|x\| \cos \theta$ にはならない（$\sqrt{\sum (\|x\| \cos \theta_i)^2}$ になる）．

**解決策：幾何（角度）を一旦忘れ，代数（線形性）で殴る**

$(w, e_j) = (x, e_j)$ を確認したいなら，定義に戻って計算するだけでいい．

ここで使う道具は，内積の双線形性と，正規直交基底の性質 $(e_i, e_j) = \delta_{ij}$（クロネッカーのデルタ：$i=j$ の時だけ $1$，他は $0$）だけだ．

証明：

定義より $w = \sum_{i=1}^k (x, e_i) e_i$ である．

これと，特定の基底ベクトル $e_j$ との内積をとる．

$$\begin{aligned} (w, e_j) &= \left( \sum_{i=1}^k (x, e_i) e_i, \quad e_j \right) \\ &= \sum_{i=1}^k (x, e_i) \underbrace{(e_i, e_j)}_{\text{線形性で外に出す}} \\ \end{aligned}$$

ここで，$(e_i, e_j)$ は $i=j$ の瞬間だけ $1$ になり，それ以外（$i \neq j$）は全部 $0$ になって消える（直交性の威力）．

よって，シグマの中で生き残るのは $i=j$ の項ただ一つである．

$$\begin{aligned} &= (x, e_j) \cdot 1 \\ &= (x, e_j) \end{aligned}$$

証明終了．

「角度」を経由せずとも，**「成分（内積の値）が一致する」**ことは代数的に保証される．

---

### 2. 演習領域：方程式の「形」を見る

問題1:

正解．$z=(0,0,5)$ は $xy$ 平面 $(z=0)$ に垂直である．完璧だ．

問題2:

条件式 $x_1 + x_2 + x_3 = 0$ までは合っている．

これは「原点を通り，法線ベクトルが $(1, 1, 1)$ の平面」である．

（3次元空間の中で，自由度が1つ減る（拘束式が1本ある）ので，次元は $3-1=2$ 次元，つまり面になる）

キミのパラメータ表示の試み $z=\frac{s}{s+t}x...$ は少し迷走している．シンプルに行こう．

$x_1 + x_2 + x_3 = 0$ を満たす解を見つけるには，**「自由な変数」**を2つ選べばいい．

例えば，$x_2 = s, x_3 = t$ と置く（パラメータ）．

すると $x_1 = -s - t$ と決まる．

これをベクトルで書くと：

$$\begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix} = \begin{pmatrix} -s - t \\ s \\ t \end{pmatrix} = s \begin{pmatrix} -1 \\ 1 \\ 0 \end{pmatrix} + t \begin{pmatrix} -1 \\ 0 \\ 1 \end{pmatrix}$$

この式が意味するのは：

「$W^\perp$ は，ベクトル $a=(-1, 1, 0)$ と $b=(-1, 0, 1)$ が張る平面である」ということだ．

図形的イメージ：

$u=(1,1,1)$ という斜めの串に垂直な円盤（平面）が，原点に刺さっている状態だ．

---

**Mode A: 講義生成 (Lecture & Transcription Mode)**

直交補空間によって，空間を「成分」と「それ以外」に分ける視点は身についた．

次はその「直交性」を保ったまま，空間全体を回したり反転させたりする変換，すなわち**「剛体運動（Rigid Motion）」**の数学的記述に入る．

これはロボティクス，3Dグラフィックス，そして量子力学（ユニタリ変換）の基礎となる．

# Lecture: Chapter 10.7 & 10.8 Orthogonal Matrix & Isometry

> Theme: Preservation of Structure (構造の保存)
> 
> Focus: 形を変えない変換とは何か？ それは「長さ」と「内積」を変えない変換のことである．

## 1. 写経セクション (Transcription Section)

_(Note: 行列 $A$ が「直交行列」であることの定義は，見た目以上に強力な意味を持つ．同値条件を全て書き写し，脳内でリンクさせよ)_

### 10.7 計量を保つ写像（等長変換）

定義 (計量を保つ写像):

内積空間 $V$ 上の線形変換 $f: V \to V$ が，任意のベクトル $x, y \in V$ に対して内積を保存するとき，これを計量を保つ写像（または等長変換）という．

$$(f(x), f(y)) = (x, y)$$

定理 (長さの保存):

内積を保つならば，自動的にノルム（長さ）も保存される．

$$\|f(x)\| = \|x\|$$

（証明：$\|f(x)\|^2 = (f(x), f(x)) = (x, x) = \|x\|^2$）

つまり，この変換は物体を歪ませたり引き伸ばしたりせず，**「回転」**や**「反転（鏡映）」**のみを行う．

### 10.8 直交行列 (Orthogonal Matrix)

計量を保つ変換を行列 $A$ で表したとき，その行列は特殊な性質を持つ．

定義 (直交行列):

実正方行列 $A$ が以下の条件を満たすとき，$A$ を直交行列と呼ぶ．

$$A^T A = I$$

（あるいは $A^{-1} = A^T$）

重要定理：直交行列の同値条件

$n$ 次正方行列 $A$ について，以下の条件はすべて同値である．

1. $A$ は直交行列である ($A^T A = I$)．
    
2. $A$ の列ベクトル $\{a_1, \dots, a_n\}$ は，$\mathbb{R}^n$ の正規直交基底をなす．
    
    （つまり，自分自身との内積は1，他との内積は0）
    
3. $A$ は長さを変えない ($\|Ax\| = \|x\|$)．
    
4. $A$ は内積を変えない ($(Ax, Ay) = (x, y)$)．
    

構造的意義 (The Structure):

条件2に注目せよ．

行列 $A$ の中身（列ベクトル）が「正規直交基底」そのものであるとき，その行列は空間を「剛体的に（歪ませずに）」変換する作用を持つ．

転置 $A^T$ が逆行列 $A^{-1}$ になるという性質は，**「逆変換（戻す操作）が，視点の転換（転置）と同じコストで行える」**ことを意味し，計算工学的に極めて重要である．

---

## 2. 再構築領域 (Reconstruction Zone)

_(Note: 定義式 $A^T A = I$ から，幾何学的な意味（正規直交性）を復元せよ)_

### 行列積の解剖

行列 $A$ を列ベクトルで分割表示する．

$A = \begin{pmatrix} | & | & & | \\ a_1 & a_2 & \dots & a_n \\ | & | & & | \end{pmatrix}$

このとき，積 $A^T A$ の $(i, j)$ 成分が何になるかを書き下せ．

1. $A^T$ は $A$ の行と列を入れ替えたものなので，その第 $i$ 行目は $a_i^T$（横ベクトル）である．
    
2. 行列の積の定義より，$(A^T A)_{ij}$ は「$A^T$ の第 $i$ 行」と「$A$ の第 $j$ 列」の積である．
    
    $$(A^T A)_{ij} = a_i^T a_j = (a_i, a_j)$$
    
    （標準内積）
    
3. $A^T A = I$（単位行列）であるとは，成分ごとの等式で書くとどうなるか？
    
    対角成分 ($i=j$): $(a_i, a_i) = \_\_\_\_\_\_$
    
    非対角成分 ($i \neq j$): $(a_i, a_j) = \_\_\_\_\_\_$
    

結論：

これはまさに，列ベクトル $\{a_1, \dots, a_n\}$ が ______ であることの定義そのものである．

---

## 3. 演習領域 (Exercise Zone)

_(Note: 具体的な直交行列を作り，その性質を肌で感じよ)_

**問題 1: 2次の直交行列**

2次正方行列 $A = \begin{pmatrix} \cos \theta & -\sin \theta \\ \sin \theta & \cos \theta \end{pmatrix}$ （回転行列）を考える．

1. 列ベクトル $a_1 = \begin{pmatrix} \cos \theta \\ \sin \theta \end{pmatrix}, a_2 = \begin{pmatrix} -\sin \theta \\ \cos \theta \end{pmatrix}$ の内積 $(a_1, a_2)$ を計算せよ．
    
    $(a_1, a_2) = \cos\theta(-\sin\theta) + \sin\theta\cos\theta = \_\_\_\_\_\_$
    
2. 各列のノルム $\|a_1\|, \|a_2\|$ を計算せよ．
    
    $\|a_1\|^2 = \cos^2\theta + \sin^2\theta = \_\_\_\_\_\_$
    
3. $A^T A$ を計算し，単位行列になることを確認せよ．
    
    $A^T A = \begin{pmatrix} \cos \theta & \sin \theta \\ -\sin \theta & \cos \theta \end{pmatrix} \begin{pmatrix} \cos \theta & -\sin \theta \\ \sin \theta & \cos \theta \end{pmatrix} = \begin{pmatrix} \_\_\_ & \_\_\_ \\ \_\_\_ & \_\_\_ \end{pmatrix}$
    

**問題 2: 逆行列の計算（瞬殺）**

行列 $B = \frac{1}{3} \begin{pmatrix} 1 & 2 & 2 \\ 2 & 1 & -2 \\ 2 & -2 & 1 \end{pmatrix}$ は直交行列である（計算不要，事実として認める）．

この行列の逆行列 $B^{-1}$ を求めよ．

（ヒント：直交行列の定義を使えば，掃き出し法などの面倒な計算は一切不要である．）

$B^{-1} = \_\_\_\_\_\_$

---

(事後チェック)

問題2: 直交行列ならば $B^{-1} = B^T$ である．単に行と列をひっくり返すだけでよい．