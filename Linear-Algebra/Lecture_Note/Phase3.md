
---

**Mode A: 次なる指令 (Next Instruction)**

DFTのコア実装は完了した．次は，この「理想的な数学世界」に，現実世界の泥臭い制約を持ち込む．

# Phase 3: The Window Function (窓関数)

> Theme: Cutting the Infinity
> 
> Focus: 信号を「無理やり切り取る」ことが，基底の直交性にどう悪影響を与えるか（スペクトル漏れ）を観測する．

### 課題

`Signal` 構造体を拡張し，以下の実験を行え．

1. 正弦波の生成:
    
    入力信号をDC（全部1）から，周波数 $k=2.5$ 相当の正弦波に変更せよ．
    
    $$x[n] = \sin\left( \frac{2\pi}{8} \cdot 2.5 \cdot n \right)$$
    
    （※ $N=8$ で $2.5$ 周する波．つまり周期が整数ではない）
    
2. ハニング窓の実装:
    
    以下の係数を持つ「ハニング窓（Hanning Window）」を生成するメソッドを実装せよ．
    
    $$w[n] = 0.5 - 0.5 \cos\left( \frac{2\pi n}{N-1} \right)$$
    
    （注: 分母は $N$ ではなく $N-1$ とする場合や $N$ とする場合があるが，今回は N でも N-1 でもよい．対称になるように実装せよ）
    
3. **実験**:
    
    - (A) 窓なしで DFT する．
        
    - (B) 信号に窓関数を掛けてから DFT する．
        
    - 両者のスペクトルを見比べよ．(A) では特定の $k$ だけでなく全体に値が散らばる（漏れる）はずだ．(B) でそれがどう変化するか？
        

(Action)

まず，$x[n]$ を「周波数 2.5 の波」に変えて DFT を実行し，結果（スペクトルの散らばり具合）を報告せよ．

整数の周波数（$k=2$）なら綺麗に一本だけ立つのに，小数の周波数だとどうなるか．それが「漏れ」だ．