素晴らしい．$10^{-16}$ という数値は，計算機が表現できる「ゼロ」の限界（マシンイプシロン）だ．

キミは，情報が何一つ失われていないことを物理的に証明した．

では，なぜそれが可能なのか？

なぜ，「複素共役」をとって「足し合わせ」て「$N$ で割る」だけで，元の信号が蘇るのか？

その数理的構造を，線形代数の頂点である**「ユニタリ性（Unitarity）」**の視点から講義する．

---

**注釈リスト**

- **エルミート共役 (Hermitian Conjugate)**: 行列の「転置 ($T$)」と「複素共役 ($\overline{\cdot}$ )」を同時に行う操作．$A^\dagger$ (ダガー) と書く．物理学では随伴行列とも呼ぶ．
    
- **ユニタリ行列 (Unitary Matrix)**: $U^\dagger U = I$ (単位行列) を満たす行列．「長さ」と「角度」を変えない回転変換を表す．
    
- **完全性関係 (Completeness Relation)**: $\sum |e_k \rangle \langle e_k| = I$．すべての基底を足し合わせると「何もしない演算子（単位行列）」になるという，量子力学の根幹原理．
    

---

## 1. 写経セクション (Transcription Section)

### A. DFT行列の構造 (Structure of DFT Matrix)

DFTの定義式を行列形式で書くと以下のようになる．

$$\mathbf{X} = F \mathbf{x}$$

ここで $F$ は，成分 $W_N^{kn}$ を持つヴァンデルモンド行列である．

$$F_{kn} = e^{-i \frac{2\pi}{N} kn}$$

この行列の各「行」は，周波数 $k$ の基底ベクトル（の共役）に対応している．

### B. 逆転の発想：$F$ の「裏返し」を作る

逆変換（IDFT）を行いたい．つまり，$\mathbf{X}$ から $\mathbf{x}$ を求めたい．

線形代数的には，両辺に左から逆行列 $F^{-1}$ を掛ければよい．

$$\mathbf{x} = F^{-1} \mathbf{X}$$

問題は，$F^{-1}$ をどうやって求めるかだ．巨大な行列の逆行列計算は通常困難だが，DFT行列には驚異的な性質がある．

**「複素共役転置（エルミート共役）をとるだけで，ほぼ逆行列になる」**

試しに $F$ とその共役転置 $F^\dagger$ を掛けてみる．

$(F^\dagger F)_{mn} = \sum_{k=0}^{N-1} (F^\dagger)_{mk} F_{kn} = \sum_{k=0}^{N-1} \overline{F_{km}} F_{kn}$

$$= \sum_{k=0}^{N-1} e^{i \frac{2\pi}{N} km} e^{-i \frac{2\pi}{N} kn} = \sum_{k=0}^{N-1} e^{i \frac{2\pi}{N} k(m-n)}$$

これは Phase 9 で見た「等比級数の和」そのものである．

- $m = n$ (対角成分) のとき：$\sum 1 = N$
    
- $m \neq n$ (非対角成分) のとき：$\sum (\text{回転}) = 0$
    

したがって：

$$F^\dagger F = \begin{bmatrix} N & 0 & \dots \\ 0 & N & \dots \\ \vdots & \vdots & \ddots \end{bmatrix} = N I$$

すなわち，$F^\dagger F = N I$ である．

両辺を $N$ で割れば：

$$\frac{1}{N} F^\dagger F = I \quad \Rightarrow \quad F^{-1} = \frac{1}{N} F^\dagger$$

結論:

逆DFT行列 $F^{-1}$ は，元の行列の**「共役（回転方向逆）」をとり，「$1/N$（大きさ補正）」**を掛けたものに等しい．

### C. IDFTの幾何学的意味 (Geometric Interpretation)

数式 $x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] e^{i \frac{2\pi}{N} kn}$ を解読する．

1. **$X[k]$**: レシピの分量（係数）．「周波数 $k$ の成分をこれだけ使え」．
    
2. **$e^{i \frac{2\pi}{N} kn}$**: 素材（基底ベクトル）．「周波数 $k$ の純粋な波」．
    
3. **$\sum$**: 調理（合成）．全ての波を混ぜ合わせる．
    
4. **$1/N$**: 最後の味付け（正規化）．DFTで内積をとった際にエネルギーが $N$ 倍に膨れ上がっているため，ここで割って帳尻を合わせる．
    

---

## 2. 再構築領域 (Reconstruction Zone)

目を離し，以下の構造図を手元で描け．

1. **行列の積**:
    
    - 行列 $F$（反時計回りの成分）と，その転置共役 $F^\dagger$（時計回りの成分）を並べて描く．
        
    - それらを掛け合わせると，対角線上にだけ「$N$」という数字が並び，それ以外は「$0$」になる様子を図示せよ．
        
    - これが「信号が混ざらずに元に戻る（直交性）」ことの代数的表現である．
        
2. **合成のイメージ**:
    
    - 何もない空間に，「低周波の波」「中周波の波」「高周波の波」を順番に足していく絵を描く．
        
    - 最初はのっぺりしていても，波を足すごとに徐々に「元のギザギザした信号」の形が浮き上がってくる様子（近似の深化）をイメージせよ．
        

---

## 3. 演習領域 (Exercise Zone)

ユニタリ性とエネルギー保存則（パーセバルの定理）の関係を確認する．

状況設定:

信号 $\mathbf{x} = [1, 1]^T$ ($N=2$) を考える．

DFT行列 $F_2 = \begin{bmatrix} 1 & 1 \\ 1 & -1 \end{bmatrix}$ （$W_2 = -1$）

問1:

DFT後のスペクトル $\mathbf{X} = F_2 \mathbf{x}$ を計算せよ．

$\mathbf{X} = \begin{bmatrix} 1 & 1 \\ 1 & -1 \end{bmatrix} \begin{bmatrix} 1 \\ 1 \end{bmatrix} = \begin{bmatrix} \_\_\_\_\_\_ \\ \_\_\_\_\_\_ \end{bmatrix}$

問2:

信号のエネルギー（二乗和）を比較せよ．

時間領域: $\|\mathbf{x}\|^2 = 1^2 + 1^2 = \_\_\_\_\_\_$

周波数領域: $\|\mathbf{X}\|^2 = (\_\_)^2 + (\_\_)^2 = \_\_\_\_\_\_$

問3:

周波数領域のエネルギーは，時間領域のエネルギーの何倍になっているか？

倍率 = $\_\_\_\_\_\_$ 倍．これは $N=2$ と一致する．

ゆえに，元のエネルギーに戻すためには，逆変換の際に $\frac{1}{N}$ を掛ける必要性がここからも理解できる．

（事後チェック用ヒント：$\mathbf{X}=[2, 0]^T$．$\|\mathbf{x}\|^2=2$, $\|\mathbf{X}\|^2=4$．エネルギーは2倍になる）