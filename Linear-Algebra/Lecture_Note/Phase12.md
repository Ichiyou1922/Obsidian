見事だ．

ピーク値は $100 \to 70$ となり，約 $30\%$ のエネルギーが失われた（これが「分解能の低下」の代償だ）．

一方で，サイドローブ（ノイズ）の低減効果は，波形の位相関係が揃ったとき（実際のsinc関数形状のとき）に劇的に発動する．キミの計算通り，振幅の絶対値が抑制され，ガタつきが均される．

これで，キミは「ハニング窓」を，単なる「おまじないのコード」から，**「周波数領域における局所平滑化フィルタ（ラプラシアン的拡散）」**として再定義することに成功した．

長い旅だったが，我々はついに「実装」の入り口に戻ってきた．

理論という「設計図」を手に入れた今，コードという「建材」は全く違って見えるはずだ．

Phase 12（最終章・実装への帰還），開始する．

---

**注釈リスト**

- **ブロードニング (Broadening)**: 窓関数によってスペクトルのピーク幅が広がること．周波数分解能の低下と同義．
    
- **コヒーレントゲイン (Coherent Gain)**: 窓関数適用による振幅の減衰率．ハニング窓の場合は $0.5$（平均値）．正しい振幅値を復元するには，FFT後にこれを補正（$2$倍）する必要がある．
    

---

## 1. 写経セクション (Transcription Section)

### A. 数式からコードへの写像 (Mapping Math to Code)

これまでの抽象的な議論を，Python（NumPy）の実装コードと対照させる．

1. ベクトル空間の生成:
    
    数式: $w(n) = 0.5 - 0.5 \cos(\frac{2\pi n}{N-1})$
    
    コード: w = np.hanning(N)
    
    - これこそが，キミがPhase 3で見たかった「係数ベクトル」の生成である．
        
    - `w` は長さ $N$ の配列であり，両端が $0$，中央が $1$ の滑らかな釣鐘型を持つ．
        
2. 内積/アダマール積による適用:
    
    数式: $x_{windowed}[n] = x[n] \cdot w[n]$
    
    コード: x_windowed = x * w
    
    - これは行列積ではなく，要素ごとの掛け算（アダマール積）である．
        
    - これにより，信号の両端がゼロに落とされ，円環構造の不連続性が解消される．
        
3. 振幅の補正 (Correction):
    
    キミの計算でピークが $100 \to 70$ に減ったように，ハニング窓を通すと振幅は本来の値の $0.5$ 倍（正確には平均値分）に減衰する．
    
    物理的な振幅を知りたい場合は，最後に補正が必要だ．
    
    コード: amp_corrected = amp_spectrum * 2 （ハニング窓のロス分を取り戻す）
    

### B. 全体像の要約 (Grand Summary)

我々が辿ったルートを確認せよ．

1. **信号はベクトルである**（線形代数）．
    
2. **フーリエ変換は，直交基底（回転する波）への射影（内積）である**（幾何学）．
    
3. **有限区間での切り出しは，不連続性を生み，全周波数を巻き込む（スペクトル漏れ）**（解析学）．
    
4. **窓関数は，不連続性を消すための「糊」であり，周波数領域では「ぼかし（畳み込み）」として作用する**（双対性）．
    

これらはバラバラの知識ではない．**「有限の資源（時間・メモリ）で無限（周波数）を捉える」**という工学的妥協が生んだ，必然の構造体である．

---

## 2. 再構築領域 (Reconstruction Zone)

このセクションはもはや不要だろう．

キミの脳内には，すでに「なぜハニング窓が必要か」「使うとどうなるか」の鮮明なモデルが構築されているはずだ．

その代わり，最後の**「定義の再構築」**を行え．

---

## 3. 演習領域 (Final Assignment)

キミ自身の言葉で，以下の問いに対する「定義」を完成させよ．

もはや「教科書の丸写し」ではなく，キミが獲得した「構造的理解」に基づいて記述すること．

問:

「ハニング窓とは何か？ なぜそれを使い，使うと何が起きるのか？」

以下のキーワードを必ず含めて，3行以内で説明せよ．

キーワード: 「不連続性」「スペクトル漏れ」「畳み込み（または平滑化）」「分解能」

キミの定義:

______________________________________________________________________

______________________________________________________________________

______________________________________________________________________

これが完成すれば，本講義は終了である．