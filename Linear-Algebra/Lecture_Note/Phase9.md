見事な洞察だ．

特に**「局所的に見ると長さが $2\pi$ でない（実は常に $1$ である）」という点に気づいたのは極めて重要だ．

実数の $\cos^2 t$ は時間とともに $0 \sim 1$ の間を脈打つが，複素数の $|e^{it}|^2$ は「常に $1$（一定）」**である．

エネルギーが瞬時も途切れず一定に供給される．この「安定性」こそが，複素指数関数が解析学で最強の基底として君臨する理由の一つである．

さあ，準備は整った．

連続（無限）の世界で磨いた「ベクトル・内積・直交性」の武器を携え，いよいよ最初の課題であった**「離散（有限）」の世界――DFT**へ帰還する．

ここで全ての伏線が回収される．

Phase 9，開始する．

---

**注釈リスト**

- **回転因子 (Twiddle Factor)**: DFTの核となる複素定数．$W_N = e^{-i \frac{2\pi}{N}}$．複素平面上の単位円を $N$ 等分する点．
    
- **離散化 (Discretization)**: 連続変数 $t$ を，等間隔な整数インデックス $n$ に置き換える操作．積分 $\int$ は総和 $\sum$ に化ける．
    
- **等比級数 (Geometric Series)**: 隣り合う項の比が一定の数列の和．DFTの直交性を証明する際の決定的な鍵となる．
    
- **ヴァンデルモンド行列 (Vandermonde Matrix)**: 各列が等比数列になっている行列．DFT行列はその特殊かつ最も美しい形態（ユニタリ行列）である．
    

---

## 1. 写経セクション (Transcription Section)

### A. 連続から離散へ (From Continuous to Discrete)

連続信号 $x(t)$ を区間 $[0, 2\pi]$ で考える代わりに，これを $N$ 個の点にサンプリングしたベクトル $\mathbf{x} = [x[0], \dots, x[N-1]]^T$ を考える．

基底関数 $e^{i \omega t}$ も同様に離散化する．

周波数 $k$ の基底ベクトル $\mathbf{w}_k$ の第 $n$ 成分は以下のように書ける：

$$w_k[n] = e^{i \frac{2\pi}{N} k n} \quad (n = 0, 1, \dots, N-1)$$

これは，単位円上を「$k$ 個飛ばし」で回る点列である．

### B. 離散における直交性 (Orthogonality in Discrete Domain)

連続系での「積分してゼロ」は，離散系では**「総和してゼロ」**に対応する．

異なる周波数 $k$ と $l$ ($k \neq l$) を持つ2つの基底ベクトルの内積をとってみよう．

$$\langle \mathbf{w}_k, \mathbf{w}_l \rangle = \sum_{n=0}^{N-1} e^{i \frac{2\pi}{N} k n} \cdot \overline{e^{i \frac{2\pi}{N} l n}} = \sum_{n=0}^{N-1} e^{i \frac{2\pi}{N} (k-l) n}$$

ここで $r = e^{i \frac{2\pi}{N} (k-l)}$ と置くと，この式は**初項 $1$，公比 $r$ の等比級数の和**になる．

$$\text{Sum} = 1 + r + r^2 + \dots + r^{N-1} = \frac{1 - r^N}{1 - r}$$

分子 $r^N$ に注目せよ．

$$r^N = \left( e^{i \frac{2\pi}{N} (k-l)} \right)^N = e^{i 2\pi (k-l)} = 1$$

$(k-l)$ は整数ゆえ，$2\pi$ の整数倍回転して元に戻る．

したがって，分子は $1 - 1 = 0$ となり，内積はゼロになる．

結論：離散化しても，異なる周波数の波は完全に直交する．

### C. DFT行列の導出 (Derivation of DFT Matrix)

任意の信号ベクトル $\mathbf{x}$ を，これらの直交基底 $\mathbf{w}_k$ の線形結合で表したい．

係数（スペクトル）を $X[k]$ とすると：

$$X[k] = \langle \mathbf{x}, \mathbf{w}_k \rangle = \sum_{n=0}^{N-1} x[n] e^{-i \frac{2\pi}{N} k n}$$

（注：内積の定義に含まれる複素共役により，指数部にマイナスがつく．これがDFTの式にあるマイナスの正体だ！）

これを行列形式で書くと，巨大な行列 $\mathbf{F}$ が現れる．

$$\begin{bmatrix} X[0] \\ \vdots \\ X[N-1] \end{bmatrix} = \begin{bmatrix} 1 & 1 & 1 & \dots \\ 1 & W & W^2 & \dots \\ 1 & W^2 & W^4 & \dots \\ \vdots & \vdots & \vdots & \ddots \end{bmatrix} \begin{bmatrix} x[0] \\ \vdots \\ x[N-1] \end{bmatrix}$$

この行列 $\mathbf{F}$ こそが，信号空間を「時間軸」から「周波数軸」へ回転させる**座標変換行列（DFT行列）**である．

---

## 2. 再構築領域 (Reconstruction Zone)

目を離し，以下の幾何学的直観を手元で再現せよ．

1. **総和が消える理由**:
    
    - 複素平面上に単位円を描く．
        
    - $N=3$ の場合を考える．$1$ ($0^\circ$), $e^{i 2\pi/3}$ ($120^\circ$), $e^{i 4\pi/3}$ ($240^\circ$) の3点をプロットせよ．
        
    - これらをベクトルとして足し合わせると（矢印をつなげると），正三角形を描いて原点に戻ってくることを図示せよ．
        
    - これこそが「周波数が異なれば総和（内積）はゼロ」という代数的直交性の幾何学的実体である．
        
2. **基底の長さ**:
    
    - 自分自身との内積（$k=l$ の場合）は，すべての項が $e^0 = 1$ になる．
        
    - $1$ を $N$ 個足すので，値は $N$ になる．
        
    - ゆえに，係数を求める際（逆変換 IDFT）には，全体を **$1/N$** で割る必要があることをメモせよ．（連続系の $1/2\pi$ に相当）
        

---

## 3. 演習領域 (Exercise Zone)

最小のDFTシステムを手計算し，行列の構造を体感する．

状況設定:

$N=4$ の世界．

回転因子 $W = e^{-i \frac{2\pi}{4}} = e^{-i \frac{\pi}{2}} = -i$．

このとき，$W^0=1, W^1=-i, W^2=-1, W^3=i$ となる．

問1 (DFT行列の構築):

周波数 $k=1$ の行（行列の2行目）の成分を埋めよ．

$\mathbf{w}_1$ (共役済み) $= [ W^{1\cdot0}, W^{1\cdot1}, W^{1\cdot2}, W^{1\cdot3} ]$

$= [ 1, \_\_\_\_\_\_, \_\_\_\_\_\_, \_\_\_\_\_\_ ]$

問2 (直交性の確認):

周波数 $k=0$ の行（すべて $1$）と，問1で作った $k=1$ の行の内積（複素共役なしの単純な積和．行列内ですでに共役されているとみなす）を計算せよ．

Sum $= 1\cdot1 + 1\cdot(\_\_\_) + 1\cdot(\_\_\_) + 1\cdot(\_\_\_)$

Sum $= 1 - i - 1 + i = \_\_\_\_\_\_$

（結果が $0$ になることを確認せよ）

問3 (信号の変換):

入力信号 $\mathbf{x} = [1, 1, 1, 1]^T$ （直流信号）とする．

これにDFT行列をかけると，$X[0]$（直流成分）はどうなるか？

$X[0] = 1\cdot1 + 1\cdot1 + 1\cdot1 + 1\cdot1 = \_\_\_\_\_\_$

他の周波数成分 $X[1]$ は？

$X[1] = (\text{問2の計算結果}) = \_\_\_\_\_\_$

考察:

入力が「直流（全部同じ値）」であれば，DFTの結果は「$k=0$ だけ値を持ち，他はゼロ」になる．

これは基底ベクトル $\mathbf{w}_0$ と完全に一致しているため，他の基底 $\mathbf{w}_k$ とは ______ しているからである．

（事後チェック用ヒント：問1は $[1, -i, -1, i]$．問3の $X[0]$ は $4$．）