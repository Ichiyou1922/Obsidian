今回は，前回の「観測者（双対空間）」を具体的に記述するための言語，すなわち**「双対基底」**と，物理学や機械学習の論文で避けて通れない**「添字のルール（上下）」**の必然性について講義する．

---

# Lecture 1-2: 双対基底とクロネッカーのデルタ (Dual Basis)

> Theme: The Canonical Pairing (標準的なペアリング)
> 
> Focus: 基準（基底）を決めた瞬間，それを測るための「目盛り（双対基底）」は自動的かつ一意に決定される．

**注釈リスト (Vocabulary)**

- **クロネッカーのデルタ (Kronecker Delta)**: 添字が等しいときだけ $1$，それ以外は $0$ を返す関数 $\delta^i_j$．「同一性の検査機」．
    
- **反変ベクトル (Contravariant Vector)**: 基底変換行列 $P$ に対し，$P^{-1}$ で変換される成分を持つベクトル（上付き添字 $v^i$）．通常のベクトル．
    
- **共変ベクトル (Covariant Vector)**: 基底変換行列 $P$ と同じ $P$ で変換される成分を持つベクトル（下付き添字 $f_i$）．コベクトル（双対ベクトル）のこと．
    
- **アインシュタインの縮約記法 (Einstein Summation Convention)**: 上付き添字と下付き添字がペアになったとき，総和記号 $\sum$ を省略して「和」をとるルール．
    

---

## 1. 写経セクション (Transcription Section)

_(Note: 記号の「位置（上下）」に極めて敏感になりながら書き写せ)_

### 1.1 双対基底の定義：定義が生み出す必然

$n$ 次元ベクトル空間 $V$ の基底を $\{e_1, e_2, \dots, e_n\}$ とする．

このとき，双対空間 $V^*$ にもまた「基底」が存在するはずである．それを $\{\epsilon^1, \epsilon^2, \dots, \epsilon^n\}$ と書こう（添字が上にあることに注意）．

これらはどのように定義されるべきか？

「$e_1$ を測ったときだけ $1$ になり，それ以外の基底 $e_j (j \neq 1)$ を測ると $0$ になる」ような測定器があれば便利である．

定義 (双対基底):

$V$ の基底 $\{e_1, \dots, e_n\}$ に対し，以下の条件を満たす $V^*$ の元 $\{\epsilon^1, \dots, \epsilon^n\}$ を双対基底 (Dual Basis) と定義する．

$$\epsilon^i(e_j) = \delta^i_j = \begin{cases} 1 & (i = j) \\ 0 & (i \neq j) \end{cases}$$

### 1.2 成分表示と「縮約」の美学

任意のベクトル $v \in V$ とコベクトル $f \in V^*$ は，それぞれの基底を使って展開できる．

1. **ベクトル（反変）:** $v = v^1 e_1 + \dots + v^n e_n = \sum_i v^i e_i$
    
2. **コベクトル（共変）:** $f = f_1 \epsilon^1 + \dots + f_n \epsilon^n = \sum_j f_j \epsilon^j$
    

ここで，$f$ が $v$ を観測する（値を食う）計算を行ってみよう．

$$f(v) = \left( \sum_j f_j \epsilon^j \right) \left( \sum_i v^i e_i \right)$$

線形性より，係数は外に出せる．また，$\epsilon^j(e_i) = \delta^j_i$ であるから，

$$f(v) = \sum_{i,j} f_j v^i \epsilon^j(e_i) = \sum_{i,j} f_j v^i \delta^j_i$$

クロネッカーのデルタ $\delta^j_i$ は，$j=i$ の項以外を消滅させる（生き残るのは $j=i$ のときのみ）．よって二重和は一重和になる．

$$f(v) = \sum_i f_i v^i$$

結論 (Einstein Notation):

上付き添字と下付き添字がペアになるとき，それは**「内積（縮約）」**を意味している．

$$f_i v^i \equiv \sum_{i=1}^n f_i v^i$$

これこそが，行列の積 (行 $\times$ 列) の正体である．

---

## 2. 再構築領域 (Reconstruction Zone)

_(Note: 計算手順のアルゴリズムを自ら構築せよ)_

### 課題: 成分抽出機の設計

あるコベクトル $f$ が与えられたとき，その成分 $f_i$ を知りたければ，何を入力すればよいか？

逆に，あるベクトル $v$ が与えられたとき，その成分 $v^i$ を「一本釣り」するには，どの測定器（コベクトル）を使えばよいか？

以下の等式を完成させ，図式化せよ．

1. コベクトルの成分抽出:
    
    $f = \sum f_k \epsilon^k$ のとき，
    
    $f(e_i) = (\sum f_k \epsilon^k)(e_i) = \dots$
    
    $\therefore f_i = f(\dots)$
    
2. ベクトルの成分抽出:
    
    $v = \sum v^k e_k$ のとき，
    
    $\epsilon^i(v) = \epsilon^i(\sum v^k e_k) = \dots$
    
    $\therefore v^i = \dots(v)$
    

**意味:**

- ベクトルの成分 $v^i$ とは，双対基底 $\epsilon^i$ で測った「測定値」である．
    
- コベクトルの成分 $f_i$ とは，基底 $e_i$ を入力したときの「出力値」である．
    

---

## 3. 演習領域 (Exercise Zone)

_(Note: 以下の問について推論し，______ を埋めて記述せよ．)_

**問題: 具体的な双対基底の構成**

$\mathbb{R}^2$ において，標準的でない基底 $V = \{e_1, e_2\}$ を以下のように選ぶ．

$$e_1 = \begin{pmatrix} 1 \\ 0 \end{pmatrix}, \quad e_2 = \begin{pmatrix} 1 \\ 1 \end{pmatrix}$$

この基底に対する双対基底 $\{\epsilon^1, \epsilon^2\}$ を求めたい．

$\epsilon^1, \epsilon^2$ は $\mathbb{R}^2$ 上の線形関数なので，$\epsilon(x, y) = ax + by$ の形をしている（つまり行ベクトル $(a, b)$ で表せる）．

Step 1: 定義の確認

双対基底の定義より，以下の連立方程式を満たす必要がある．

$\epsilon^1(e_1) = 1, \quad \epsilon^1(e_2) = 0$

$\epsilon^2(e_1) = 0, \quad \epsilon^2(e_2) = 1$

Step 2: $\epsilon^1$ の導出

$\epsilon^1$ を行ベクトル $(a_1, b_1)$ とする．

$\epsilon^1(e_1) = (a_1, b_1) \begin{pmatrix} 1 \\ 0 \end{pmatrix} = a_1 = 1$

$\epsilon^1(e_2) = (a_1, b_1) \begin{pmatrix} 1 \\ 1 \end{pmatrix} = a_1 + b_1 = 0 \implies 1 + b_1 = 0 \implies b_1 = -1$

よって，$\epsilon^1$ の行ベクトル表現は $(1, -1)$ である．

関数として書けば，$\epsilon^1(x, y) = x - y$．

Step 3: $\epsilon^2$ の導出

同様に，$\epsilon^2$ を行ベクトル $(a_2, b_2)$ として計算せよ．

$\epsilon^2(e_1) = a_2 = \_\_\_\_\_\_$

$\epsilon^2(e_2) = a_2 + b_2 = 1 \implies b_2 = \_\_\_\_\_\_$

よって，$\epsilon^2$ の行ベクトル表現は $\_\_\_\_\_\_$ である．

関数として書けば，$\epsilon^2(x, y) = \_\_\_\_\_\_$．

考察:

元の基底 $e_1, e_2$ を列ベクトルとして並べた行列を $P = (e_1 \ e_2) = \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}$ とする．

今回求めた双対基底の行ベクトルを縦に並べた行列 $Q = \begin{pmatrix} \epsilon^1 \\ \epsilon^2 \end{pmatrix} = \begin{pmatrix} 1 & -1 \\ \dots & \dots \end{pmatrix}$ を作る．

$Q$ と $P$ の積 $QP$ を計算するとどうなるか？

$$QP = \begin{pmatrix} 1 & -1 \\ \dots & \dots \end{pmatrix} \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix} = \begin{pmatrix} \dots & \dots \\ \dots & \dots \end{pmatrix}$$

結論: 双対基底を行ベクトルとして並べた行列は，元の基底行列の $\_\_\_\_\_\_$ 行列になっている．

---

### 学問への接続 (Academic Connection)

この「$e_i$ と $\epsilon^i$ の直交性（双対性）」は，信号処理における**「フーリエ変換」の核心である．

時間の関数 $f(t)$ を周波数成分 $F(\omega)$ に分解するとき，我々は $e^{i\omega t}$ という基底の「双対（共役）」を掛けて積分している．

また，結晶物理学（固体物理）では，原子が並ぶ「実格子ベクトル」に対し，回折パターン（X線解析）に現れる周期性を記述するために「逆格子ベクトル（Reciprocal Lattice）」**を用いる．この逆格子こそが，物理的な双対基底そのものである．

### Reference

- Introduction to Tensor Analysis and the Calculus of Moving Surfaces (Pavel Grinfeld) - Part I
    
- Linear Algebra Done Right (Axler) - Chapter 3.F Duality